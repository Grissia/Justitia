<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŠ½ç±¤æ©Ÿ by Grissia</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ² æŠ½ç±¤æ©Ÿ by Grissia ğŸ²</h1>
        <form id="lotteryForm" method="POST" class="input-section">
            <label for="items" class="input-label">ğŸ”¤ è¼¸å…¥å…¶ä»–æŠ½ç±¤é …ç›®ï¼ˆç”¨é€—è™Ÿåˆ†éš”ï¼‰ï¼š</label>
            <textarea id="items" name="items" rows="4" placeholder="é …ç›®1, é …ç›®2, é …ç›®3">{{ ', '.join(numbers)}}</textarea>
            <button type="submit" id="drawButton" class="btn">ğŸ‰ é–‹å§‹æŠ½ç±¤ï¼</button>
        </form>

        <div class="result">
            <div id="animation" class="hidden">ğŸ‰ æŠ½ä¸­çµæœæ˜¯ï¼š<span id="resultText"></span> ğŸ‰</div>
        </div>
    </div>

    <script>
        // å¾å¾Œç«¯ç²å–é è¼‰å…¥çš„è™Ÿç¢¼
        fetch("/api/numbers")
            .then(response => response.json())
            .then(data => {
                const list = document.getElementById("presetNumbers");
                if (data.length > 0) {
                    data.forEach(item => {
                        const li = document.createElement("li");
                        li.textContent = item;
                        list.appendChild(li);
                    });
                } else {
                    list.innerHTML = "<li>ç›®å‰æ²’æœ‰é è¼‰å…¥çš„è™Ÿç¢¼ã€‚</li>";
                }
            });

        document.getElementById("lotteryForm").addEventListener("submit", function(event) {
            event.preventDefault();

            const itemsInput = document.getElementById("items").value;
            const items = itemsInput.split(",").map(item => item.trim()).filter(item => item);
            const animation = document.getElementById("animation");
            const resultText = document.getElementById("resultText");

            if (items.length === 0) {
                alert("è«‹è¼¸å…¥è‡³å°‘ä¸€å€‹é …ç›®ï¼");
                return;
            }

            // é–‹å§‹å‹•ç•«
            animation.classList.remove("hidden");
            resultText.textContent = "æ­£åœ¨æŠ½ç±¤...";

            // æ¨¡æ“¬å»¶é²æ•ˆæœ
            setTimeout(() => {
                const finalResult = items[Math.floor(Math.random() * items.length)];
                resultText.textContent = finalResult;
            }, 1000); // å‹•ç•«é¡¯ç¤º 2 ç§’å¾Œé¡¯ç¤ºçµæœ
        });
    </script>
</body>
</html>
